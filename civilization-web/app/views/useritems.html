<div ng-controller="UserItemController as userCtrl">
  <div class="row padd-top-7">

    <div class="col-lg-7">
      <button class="btn btn-info" ng-click="privateLogCollapse = !privateLogCollapse">Toggle Private log</button>
      <hr>
      <div collapse="privateLogCollapse">
        <table ng-table="userCtrl.tablePrivateLog" ng-show="$data.length > 0"
               class="table table-bordered table-hover table-condensed text-center table-responsive">
          <tr ng-repeat="log in $data" class="active" ng-class-even="'row-even'" ng-class-odd="'row-odd'">
            <td data-title="'Date'" sortable="'created'">{{log.created | date:'dd-MM-yyyy HH:mm:ss'}}</td>
            <td data-title="'Log'" sortable="'log'">{{log.log}}</td>
            <td data-title="'Action'">
              <button ng-if="canInitiateDraw(log)"
                      ng-really-message="This will initiate vote for Undo. Are you sure?"
                      ng-really-click="initiateUndo(log.id)"
                      class="btn btn-sm btn-warning" tooltip="Press undo button to request a vote for undo. All players must vote yes for undo to be made.
                  Once all players have voted yes, the item will be put back in the deck and reshuffled">
                Undo
              </button>
            </td>
          </tr>
        </table>
      </div>
    </div>
    <div class="col-lg-5" ng-if="gameCtrl.yourTurn">
      <div class="btn-group" dropdown is-open="status.isopen">
        <button type="button" class="btn btn-primary dropdown-toggle" dropdown-toggle ng-disabled="disabled">
          Choose Item to Draw <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" role="menu">
          <li><a href="#" tooltip="Draw a civilization, for instance America">Civs</a></li>
          <li class="divider"></li>
          <li><a href="#">Culture I</a></li>
          <li><a href="#">Culture II</a></li>
          <li><a href="#">Culture III</a></li>
          <li class="divider"></li>
          <li><a href="#">Aircraft</a></li>
          <li><a href="#">Artillery</a></li>
          <li><a href="#">Infantry</a></li>
          <li><a href="#">Mounted</a></li>
          <li class="divider"></li>
          <li><a href="#">Village</a></li>
          <li><a href="#">Hut</a></li>
          <li class="divider"></li>
          <li><a href="#">City-State</a></li>
          <li><a href="#">Great Person</a></li>
          <li><a href="#">Tile</a></li>
          <li><a href="#">Wonder</a></li>
        </ul>
      </div>
    </div>
  </div>

  <div class="row padd-top-7">
    <div class="col-md-2">
      <button class="btn btn-info" ng-click="itemCollapse = !itemCollapse">Toggle Items</button>
      <hr>
      <div collapse="itemCollapse">
        <div class="well well-lg">
          <ul>
            <li ng-repeat="item in userCtrl.items">
              {{userCtrl.nextElement(item).sheetName}} : {{userCtrl.nextElement(item).name}}
              <ul>
                <li>
                  <button ng-really-message="This will discard your item. Are you sure?"
                          ng-really-click="userCtrl.discardItem(item)"
                          class="btn btn-sm btn-warning"
                          tooltip="Discard your item. This will make an entry in the game log">
                    Discard Item
                  </button>
                </li>
                <li>
                  <button class="btn btn-sm btn-warning" disabled>
                    Send to Player
                  </button>
                </li>
                <li>
                  <button class="btn btn-sm btn-warning" disabled>
                    Reveal Item
                  </button>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </div>
    </div>
    <div class="col-sm-3">
      <button class="btn btn-info" ng-click="gpCollapse = !gpCollapse ">Toggle Great Persons</button>
      <hr>
      <div collapse="gpCollapse">
        <div ng-repeat="item in userCtrl.greatPersons" class="thumbnail" ng-show="userCtrl.greatPersons"
             ng-show="userCtrl.greatPersons">
          <img ng-src="/images/useritems/{{item.greatperson.image}}" tooltip="{{item.greatperson.name}}"/>

          <div class="caption">
            <h3 class="text-center">{{item.greatperson.name}}</h3>
            <p class="text-justify">
              {{item.greatperson.description}}
            </p>

            <p>
              <button ng-really-message="This will discard your item. Are you sure?"
                      ng-really-click="userCtrl.discardItem(item)"
                      class="btn btn-sm btn-warning"
                      tooltip="Discard your item. This will make an entry in the game log">
                Discard Item
              </button>
              <button ng-really-message="This will reveal your item. Are you sure?"
                      ng-really-click="userCtrl.revealItem(item)"
                      ng-disabled="item.greatperson.hidden == false"
                      class="btn btn-sm btn-warning"
                      tooltip="Reveal your item. This will make an entry in the game log and display hidden information">
                Reveal Item
              </button>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-2">
      <button class="btn btn-info" ng-click="unitCollapse = !unitCollapse">Toggle Units</button>
      <hr>
      <div collapse="unitCollapse"> <!--TODO orderBy doesnt work-->
        <div ng-repeat="item in userCtrl.units | orderBy: 'name'" class="thumbnail" ng-show="userCtrl.units">
          <img ng-src="/images/useritems/{{userCtrl.nextElement(item).image}}"
               tooltip="{{userCtrl.nextElement(item).name}}"/>

          <div class="caption">
            <h3 class="text-center">{{userCtrl.nextElement(item).name}}</h3>
            <p>
              <button ng-really-message="This will discard your item. Are you sure?"
                      ng-really-click="userCtrl.discardItem(item)"
                      class="btn btn-sm btn-warning"
                      tooltip="Discard your item. This will make an entry in the game log">
                Discard Unit
              </button>
              <button ng-really-message="This will reveal your unit. Are you sure?"
                      ng-really-click="userCtrl.revealItem(item)"
                      ng-disabled="userCtrl.nextElement(item).hidden == false"
                      class="btn btn-sm btn-warning"
                      tooltip="Reveal your item. This will make an entry in the game log and display hidden information">
                Reveal Unit
              </button>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-2">
      <button class="btn btn-info" ng-click="cultureCardsCollapse = !cultureCardsCollapse">Toggle Culture Cards</button>
      <hr>
      <div collapse="cultureCardsCollapse">
        <div ng-repeat="item in userCtrl.cultureCards" class="thumbnail" ng-show="userCtrl.cultureCards">
          <img ng-src="/images/useritems/{{userCtrl.nextElement(item).image}}"
               tooltip="{{userCtrl.nextElement(item).description}}"/>

          <div class="caption">
            <h3 class="text-center">{{userCtrl.nextElement(item).name}}</h3>
            <p class="text-justify">
              {{userCtrl.nextElement(item).description}}
            </p>
            <p>
              <button ng-really-message="This will discard your item. Are you sure?"
                      ng-really-click="userCtrl.discardItem(item)"
                      class="btn btn-sm btn-warning"
                      tooltip="Discard your item. This will make an entry in the game log">
                Discard Item
              </button>
              <button tooltip="TODO" class="btn btn-sm btn-warning" disabled>
                Send to Player
              </button>
              <button tooltip="TODO" class="btn btn-sm btn-warning" disabled>
                Reveal Item
              </button>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-2">
      <button class="btn btn-info" ng-click="hutsCollapse = !hutsCollapse">Toggle Huts</button>
      <hr>
      <div collapse="hutsCollapse">
        <div ng-repeat="item in userCtrl.huts" class="thumbnail" ng-show="userCtrl.huts">
          <img ng-src="/images/useritems/{{item.hut.image}}"
               tooltip="{{item.hut.name}}"/>

          <div class="caption">
            <h3 class="text-center">{{item.hut.name}}</h3>
            <p>
              <button ng-really-message="This will discard your item. Are you sure?"
                      ng-really-click="userCtrl.discardItem(item)"
                      class="btn btn-sm btn-warning"
                      tooltip="Discard your item. This will make an entry in the game log">
                Discard Item
              </button>
              <button tooltip="TODO" class="btn btn-sm btn-warning" disabled>
                Send to Player
              </button>
              <button tooltip="TODO" class="btn btn-sm btn-warning" disabled>
                Reveal Item
              </button>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-sm-1">
      <button class="btn btn-info" ng-click="villagesCollapse = !villagesCollapse">Toggle Villages</button>
      <hr>
      <div collapse="villagesCollapse">
        <div ng-repeat="item in userCtrl.villages" class="thumbnail" ng-show="userCtrl.villages">
          <img ng-src="/images/useritems/{{item.village.image}}"
               tooltip="{{item.village.name}}"/>

          <div class="caption">
            <h3 class="text-center">{{item.village.name}}</h3>

            <p>
              <button ng-really-message="This will discard your item. Are you sure?"
                      ng-really-click="userCtrl.discardItem(item)"
                      class="btn btn-sm btn-warning"
                      tooltip="Discard your item. This will make an entry in the game log">
                Discard Item
              </button>
              <button tooltip="TODO" class="btn btn-sm btn-warning" disabled>
                Send to Player
              </button>
              <button tooltip="TODO" class="btn btn-sm btn-warning" disabled>
                Reveal Item
              </button>
            </p>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- allAvailableTechs -->
  <div class="row">
    <hr/>
    <h2>Your Techs</h2>

    <div class="well well-lg col-lg-8">
      List of all the techs chosen
      <ul>
        <li ng-repeat="tech in userCtrl.chosenTechs | filter: tech.level == 1">
          Name {{tech.name}}
        </li>
      </ul>

      <ul>
        <li ng-repeat="tech in userCtrl.chosenTechs | filter: tech.level == 2">
          Name {{tech.name}}
        </li>
      </ul>

      <ul>
        <li ng-repeat="tech in userCtrl.chosenTechs | filter: tech.level == 3">
          Name {{tech.name}}
        </li>
      </ul>

      <ul>
        <li ng-repeat="tech in userCtrl.chosenTechs | filter: tech.level == 5">
          Name {{tech.name}}
        </li>
      </ul>

    </div>
    <div class="well well-lg col-lg-4">
      Choose tech here, put data in select box
      <p>Selected: {{userCtrl.tech.selected}}</p>
      <ui-select ng-model="userCtrl.tech.selected" theme="bootstrap" ng-disabled="disabled" style="width: 300px;">
        <ui-select-match placeholder="Select or search a tech">{{$select.selected.name}}</ui-select-match>
        <ui-select-choices repeat="tech in userCtrl.allAvailableTechs | filter: $select.search">
          <span ng-bind-html="tech.tech.name | highlight: $select.search"></span>
        </ui-select-choices>
      </ui-select>
    </div>
  </div>
</div>
